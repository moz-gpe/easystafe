% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/processar_esistafe_extracto_unico.R
\name{processar_esistafe_extracto_unico}
\alias{processar_esistafe_extracto_unico}
\title{Processamento hierárquico e consolidação de um único extracto do e-SISTAFE}
\usage{
processar_esistafe_extracto_unico(caminho, lista_ugb)
}
\arguments{
\item{caminho}{Caminho completo do ficheiro Excel a ser processado.}

\item{lista_ugb}{Vetor de códigos UGB a manter (os restantes são marcados como "Remove").}
}
\value{
Um tibble contendo o extracto processado e consolidado para um único ficheiro,
sem duplicações e com o nível hierárquico final escolhido automaticamente.
}
\description{
Esta função processa um ficheiro individual do e-SISTAFE, executando
um conjunto estruturado de operações para produzir um extracto
totalmente consolidado e não duplicado a partir dos diferentes níveis
hierárquicos de CED (A, B, C e D).
}
\details{
O processamento inclui:
\itemize{
\item limpeza e normalização do extracto original;
\item classificação do grupo CED para cada linha (A, B, C, D);
\item aplicação de regras de subtração hierárquica entre níveis:
\itemize{
\item C → D
\item B → D
\item A → D
\item B → C
\item A → C
\item A → B
}
\item atribuição de prioridade (D > C > B > A) e seleção do valor final;
\item devolução de um extracto “único” representando o nível mais granular disponível.
}
}
\examples{
\dontrun{
df <- processar_esistafe_extracto_unico(
  caminho = "Data/Extracto_20240201.xlsx",
  lista_ugb = c("010100001")
)
}

}
